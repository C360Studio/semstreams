// Code generated by semstreams-gqlgen. DO NOT EDIT.

package robotapi

import (
	"context"
	"github.com/c360/semstreams/gateway/graphql"
)

// Resolver is the root resolver
type Resolver struct {
	base *graphql.BaseResolver
}

// NewResolver creates a new resolver
func NewResolver(base *graphql.BaseResolver) *Resolver {
	return &Resolver{base: base}
}

// Query returns the query resolver
func (r *Resolver) Query() QueryResolver {
	return &queryResolver{r}
}

// QueryResolver resolves queries
type QueryResolver interface {
	SearchRobots(ctx context.Context, query string, limit int) ([]*Robot, error)
	Robot(ctx context.Context, id string) (*Robot, error)
	Robots(ctx context.Context, ids []string) ([]*Robot, error)
	Task(ctx context.Context, id string) (*Task, error)
	Tasks(ctx context.Context, ids []string) ([]*Task, error)
}

type queryResolver struct{ *Resolver }

// SearchRobots resolves the SearchRobots query
func (r *queryResolver) SearchRobots(ctx context.Context, query string, limit int) ([]*Robot, error) {
	results, err := r.base.SemanticSearch(ctx, query, limit)
	if err != nil {
		return nil, err
	}

	// Convert search results to entities
	entities := make([]*graphql.Entity, len(results))
	for i, result := range results {
		entities[i] = result.Entity
	}

	return entitiesRobot(entities)
}

// Robot resolves the Robot query
func (r *queryResolver) Robot(ctx context.Context, id string) (*Robot, error) {
	entity, err := r.base.QueryEntityByID(ctx, id)
	if err != nil {
		return nil, err
	}
	return entityRobot(entity)
}

// Robots resolves the Robots query
func (r *queryResolver) Robots(ctx context.Context, ids []string) ([]*Robot, error) {
	entities, err := r.base.QueryEntitiesByIDs(ctx, ids)
	if err != nil {
		return nil, err
	}
	return entitiesRobot(entities)
}

// Task resolves the Task query
func (r *queryResolver) Task(ctx context.Context, id string) (*Task, error) {
	entity, err := r.base.QueryEntityByID(ctx, id)
	if err != nil {
		return nil, err
	}
	return entityTask(entity)
}

// Tasks resolves the Tasks query
func (r *queryResolver) Tasks(ctx context.Context, ids []string) ([]*Task, error) {
	entities, err := r.base.QueryEntitiesByIDs(ctx, ids)
	if err != nil {
		return nil, err
	}
	return entitiesTask(entities)
}
